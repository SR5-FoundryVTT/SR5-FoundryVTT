{{#each nodes as |node|}}
    {{!-- Render the current folder or pack row --}}
    <div 
        class="pack-row {{#if node.isFolder}}folder collapsible{{/if}} {{#if node.collapsed}}collapsed{{/if}}" 
        style="--depth: {{../depth}};"
        data-path="{{node.path}}"
    >
        <label>
            <input 
                type="checkbox" 
                data-path="{{node.path}}"
                {{#if (eq node.selectionState "all")}}checked{{/if}}>
            {{#if node.isFolder}}
                <a class="collapse-toggle" data-action="toggleCollapse"><i class="fa-solid fa-caret-down"></i></a>
            {{/if}}
            <span>{{node.name}}</span>
        </label>
        <div class="children-container">
            {{#if node.isFolder}}
                {{> 'systems/shadowrun5e/dist/templates/apps/compendium-browser/settings-folder.hbs' nodes=node.children depth=(sum ../depth 1)}}
            {{/if}}
        </div>
    </div>
{{/each}}
