<header class="sheet-header">
    <img
        class="sheet-image"
        src="{{actor.img}}"
        data-edit="img"
        data-tooltip="{{actor.name}}"
    />
    <div class="sheet-header-labels">
        <div class="sheet-header-name">
            {{#if (hasAnyFreshImports actor)}}
                {{#if @root.isEditMode}}
                    <button type="button" class="toggle-fresh-import" data-tooltip="SR5.MarkImportsTooltip" data-action="toggleFreshImports">
                        <img src="systems/shadowrun5e/dist/icons/checklist-white.svg" width="32px" height="32px" />
                    </button>
                {{else}}
                    <label data-tooltip="SR5.MarkImportsTooltip" style="width: 1.5rem; flex-shrink: 0;">
                        <img src="systems/shadowrun5e/dist/icons/checklist.svg" width="32px" height="32px" />
                    </label>
                {{/if}}
            {{/if}}
            {{#if (and @root.isPlayMode system.description.source)}}
                <a data-action="openSource" data-tooltip="SR5.OpenSource" style="font-size: 1.5rem">
                    {{#if sourceIsURL}}
                        <i class="fas fa-link"></i>
                    {{else if sourceIsPDF}}
                        <i class="fas fa-file-pdf"></i>
                    {{else if sourceIsUuid}}
                        <i class="fas fa-file"></i>
                    {{else}}
                        <i class="fas fa-question"></i>
                    {{/if}}
                </a>
            {{else if @root.isEditMode}}
                <div>
                    {{formInput systemFields.description.fields.source value=source.system.description.source
                                placeholder=(localize "SR5.Source") classes="thicc" rootId=rootId}}
                </div>
            {{/if}}
            <div style="flex: 1">
                {{formInput fields.name value=actor.name
                            placeholder=(localize "SR5.Name") disabled=@root.isPlayMode rootId=rootId}}
            </div>
        </div>
        {{#if @root.isEditMode}}
        {{else}}
            <div>
                {{#if (or isIC isSprite)}}
                    {{> 'systems/shadowrun5e/dist/templates/v2/actor/parts/condition-monitor.hbs'
                        id='matrix'
                        track = system.track.matrix
                    }}
                {{/if}}
                {{#if (or isCharacter isSpirit)}}
                    {{> 'systems/shadowrun5e/dist/templates/v2/actor/parts/condition-monitor.hbs'
                        id='stun'
                        track = system.track.stun
                    }}
                {{/if}}
                {{#unless (or isIC isSprite)}}
                    {{> 'systems/shadowrun5e/dist/templates/v2/actor/parts/condition-monitor.hbs'
                        id='physical'
                        track = system.track.physical
                    }}
                {{/unless}}
            </div>
        {{/if}}
    </div>
    <div class="sheet-header-col">
        {{> 'systems/shadowrun5e/dist/templates/v2/actor/parts/initiative.hbs' }}
        {{#if @root.isEditMode}}
            <div>
                <div class="new-list-item">
                    <div class="new-list-item-label-container">
                        <label data-tooltip="{{systemFields.attributes.fields.edge.fields.base.hint}}">
                            {{systemFields.attributes.fields.edge.fields.base.label}}
                        </label>
                    </div>
                    <div class="new-list-item-col">
                        {{formInput systemFields.attributes.fields.edge.fields.base value=system.attributes.edge.base
                                    rootId=rootId class="short"}}
                    </div>
                </div>
            </div>
        {{else}}
            {{#if system.attributes.edge.value}}
                {{> 'systems/shadowrun5e/dist/templates/v2/common/horizontal-cells.hbs'
                    tooltip="SR5.AttrEdge"
                    value=system.attributes.edge.uses
                    max=system.attributes.edge.value
                    id="edge" }}
            {{/if}}
        {{/if}}
        {{#if (eq actor.type 'vehicle')}}
            <div>
                {{#if vehicle.driver}}
                    <div class="new-list-item">
                        <div class="new-list-item-label-container">
                            <div>
                                <a class="content-link" draggable="true" data-link data-type="Actor" data-id="{{vehicle.driver.id}}" data-uuid="{{vehicle.driver.uuid}}">
                                    <i class="fas fa-steering-wheel"></i>{{vehicle.driver.name}}
                                    <a data-action="removeVehicleDriver" class="close"><i class="fas fa-times"></i></a>
                                </a>
                            </div>
                        </div>
                        <div class="new-list-item-col" data-tooltip="SR5.Vehicle.ControlMode">
                            {{formInput systemFields.controlMode value=source.system.vehicle.controlMode
                                            classes="short" localize=true }}
                        </div>
                    </div>
                {{else}}
                    <a data-action="pickDriver" data-tooltip="SR5.Tooltips.Actor.PickControlledTokenAsDriver">
                        <span class="fa-stack" style="vertical-align: top; font-size: 0.75em">
                            <i class="fa-light fa-square-dashed fa-stack-2x"></i>
                            <i class="fas fa-steering-wheel fa-stack-1x"></i>
                        </span>
                        {{localize "SR5.Vehicle.MissingDriver"}}
                    </a>
                {{/if}}
            </div>
        {{/if}}
        {{#if (or isSpirit isSprite)}}
            <div>
                <div class="new-list-item">
                    <div class="new-list-item-label-container">
                        {{#if isSpirit}}
                            {{#if summoner}}
                                <a class="content-link" draggable="true" data-link data-type="Actor" data-id="{{summoner.id}}" data-uuid="{{summoner.uuid}}">
                                    <i class="fas fa-ghost"></i>{{summoner.name}}
                                    <a class="close summoner-remove"><i class="fas fa-times"></i></a>
                                </a>
                            {{else}}
                                <a data-action="pickSummoner" data-tooltip="SR5.Tooltips.Actor.PickControlledTokenAsSummoner">
                                    <span class="fa-stack" style="vertical-align: top; font-size: 0.75em">
                                        <i class="fa-light fa-square-dashed fa-stack-2x"></i>
                                        <i class="fas fa-ghost fa-stack-1x"></i>
                                    </span>
                                    {{localize "SR5.Spirit.MissingSummoner"}}
                                </a>
                            {{/if}}
                        {{else}}
                            {{#if technomancer}}
                                <a class="content-link" draggable="true" data-link data-type="Actor" data-id="{{technomancer.id}}" data-uuid="{{technomancer.uuid}}">
                                    <i class="fas fa-user"></i>{{technomancer.name}}
                                    <a class="close technomancer-remove"><i class="fas fa-times"></i></a>
                                </a>
                            {{else}}
                                <a data-action="pickTechnomancer" data-tooltip="SR5.Tooltips.Actor.PickControlledTokenAsTechnomancer">
                                    <span class="fa-stack" style="vertical-align: top; font-size: 0.75em">
                                        <i class="fa-light fa-square-dashed fa-stack-2x"></i>
                                        <i class="fas fa-user fa-stack-1x"></i>
                                    </span>
                                    {{localize "SR5.Sprite.MissingTechnomancer"}}
                                </a>
                            {{/if}}
                        {{/if}}
                    </div>
                    <div class="new-list-item-col qty-input-col"
                         data-tooltip="{{#if isSpirit}}SR5.Spirit.Services{{else}}SR5.Sprite.Services{{/if}}">
                        {{#if @root.isEditMode}}
                            {{formInput systemFields.services value=system.services rootId=rootId class="short"}}
                        {{else}}
                            <a class="hover-show-button"
                               data-action="removeOneService"
                               data-tooltip="SR5.Labels.ActorSheet.RemoveOneService">
                                <i class="fas fa-minus-square"></i>
                            </a>
                            <label>{{system.services}}</label>
                            <a class="hover-show-button"
                               data-action="addOneService"
                               data-tooltip="SR5.Labels.ActorSheet.AddOneService">
                                <i class="fas fa-plus-square"></i>
                            </a>
                        {{/if}}
                    </div>
                </div>
            </div>
        {{/if}}
    </div>
</header>
