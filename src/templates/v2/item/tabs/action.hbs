<section class="tab hide-overflow{{#if tab.active}} active{{/if}}" data-group="{{tab.group}}" data-tab="{{tab.id}}">
    <div class="fill-container">
        <div class="scrollable">
            <div class="list-item">
                <div class="list-item-start skinny">
                    <label data-tooltip="{{systemFields.action.fields.test.hint}}">{{systemFields.action.fields.test.label}}</label>
                </div>
                <div class="list-item-col">
                    {{formInput systemFields.action.fields.test value=system.action.test options=(tests2Array activeTests)
                                classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                </div>
            </div>
            {{#if (eq item.type 'action')}}
                <div class="list-item">
                    <div class="list-item-start skinny">
                        <label data-tooltip="{{systemFields.action.fields.categories.hint}}">{{systemFields.action.fields.categories.label}}</label>
                    </div>
                    <div class="list-item-col">
                        {{formInput systemFields.action.fields.categories value=system.action.categories options=config.actionCategories
                                    classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                    </div>
                </div>
            {{/if}}
            <div class="list-item">
                <div class="list-item-start skinny">
                    <label data-tooltip="{{systemFields.action.fields.type.hint}}">{{systemFields.action.fields.type.label}}</label>
                </div>
                <div class="list-item-col">
                    <span data-tooltip="SR5.ExtendedTest">
                        {{formInput systemFields.action.fields.extended value=system.action.extended
                                    classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                    </span>
                    {{formInput systemFields.action.fields.type value=system.action.type localize=true
                                classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                </div>
            </div>
            {{#if system.action.type}}
                <div class="list-item">
                    <div class="list-item-start skinny">
                        <label data-tooltip="{{systemFields.action.fields.modifiers.hint}}">{{systemFields.action.fields.modifiers.label}}</label>
                    </div>
                    <div class="list-item-col">
                        {{formInput systemFields.action.fields.modifiers value=system.action.modifiers options=config.modifierTypes
                                        localize=true classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                    </div>
                </div>
                <div class="list-item">
                    <div class="list-item-start skinny">
                        <label>{{localize "SR5.Roll"}}</label>
                    </div>
                    <div class="list-item-col">
                        {{!-- Hide this field the attribtue2 is set and the skill isn't set --}}
                        {{#unless (and system.action.attribute2 (not system.action.skill))}}
                            <span data-tooltip="{{systemFields.action.fields.spec.label}}: {{systemFields.action.fields.spec.hint}}">
                                {{formInput systemFields.action.fields.spec value=system.action.spec
                                            classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                            </span>
                            {{formInput systemFields.action.fields.skill value=system.action.skill options=(config2Array activeSkills) localize=true
                                        classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                            <label>+</label>
                        {{/unless}}
                        {{formInput systemFields.action.fields.attribute value=system.action.attribute options=(config2Array attributes)
                                    localize=true classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                        {{#unless system.action.skill}}
                            <label>+</label>
                            {{formInput systemFields.action.fields.attribute2 value=system.action.attribute2 options=(config2Array attributes)
                                        localize=true classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                        {{/unless}}
                        <label>+</label>
                        {{formInput systemFields.action.fields.mod value=system.action.mod
                                    classes="short skinny" rootId=@root.rootId disabled=@root.isPlayMode}}
                        <label>+</label>
                        <a data-tooltip="{{systemFields.action.fields.armor.label}}:&nbsp;{{systemFields.action.fields.armor.hint}}"
                           data-action="toggleActionArmor">
                            {{#if system.action.armor}}
                                <i class="fas fa-shield"></i>
                            {{else}}
                                <i class="far fa-shield"></i>
                            {{/if}}
                        </a>
                    </div>
                </div>
                {{#ifne item.type "spell"}}{{#ifne item.type "complex_form"}}
                    <div class="list-item">
                        <div class="list-item-start skinny">
                            <label data-tooltip="{{systemFields.action.fields.limit.fields.base.hint}}">{{systemFields.action.fields.limit.fields.base.label}}</label>
                        </div>
                        <div class="list-item-col">
                            {{formInput systemFields.action.fields.limit.fields.attribute value=system.action.limit.attribute options=(config2Array limits)
                                        localize=true classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                            <label>+</label>
                            {{formInput systemFields.action.fields.limit.fields.base value=system.action.limit.base
                                        classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                        </div>
                    </div>
                    <div class="list-item">
                        <div class="list-item-start skinny">
                            <label data-tooltip="{{systemFields.action.fields.threshold.fields.base.hint}}">{{systemFields.action.fields.threshold.fields.base.label}}</label>
                        </div>
                        <div class="list-item-col">
                            {{formInput systemFields.action.fields.threshold.fields.base
                                        value=system.action.threshold.base
                                        classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                        </div>
                    </div>
                    <div class="list-item">
                        <div class="list-item-start skinny">
                            <label data-tooltip="{{systemFields.action.fields.roll_mode.hint}}">{{systemFields.action.fields.roll_mode.label}}</label>
                        </div>
                        <div class="list-item-col">
                            {{formInput systemFields.action.fields.roll_mode value=system.action.roll_mode localize=true
                                        classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                        </div>
                    </div>
                {{/ifne}}{{/ifne}}
            {{/if}}
            <div class="list-item list-item-header">
                <div class="list-item-start skinny">
                    <label>{{localize "SR5.Damage"}}</label>
                </div>
            </div>
            <div class="list-item">
                <div class="list-item-start skinny">
                    <label data-tooltip="{{systemFields.action.fields.damage.fields.type.fields.base.hint}}">{{systemFields.action.fields.damage.fields.type.fields.base.label}}</label>
                </div>
                <div class="list-item-col">
                    {{formInput systemFields.action.fields.damage.fields.type.fields.base
                                value=system.action.damage.type.base localize=true
                                classes="short thicc" rootId=@root.rootId disabled=@root.isPlayMode}}

                    {{#if system.action.damage.type.base}}
                        {{#if (eq system.action.damage.type.base "matrix")}}
                            <label>
                                {{localize "SR5.Biofeedback"}}&nbsp;{{formInput systemFields.action.fields.damage.fields.biofeedback
                                            value=system.action.damage.biofeedback localize=true
                                            classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                            </label>
                        {{else}}
                            <span data-tooltip="SR5.Element">
                                {{formInput systemFields.action.fields.damage.fields.element.fields.base
                                            value=system.action.damage.element.base localize=true
                                            classes="short thicc" rootId=@root.rootId disabled=@root.isPlayMode}}
                            </span>
                        {{/if}}
                    {{/if}}
                </div>
            </div>

            {{#if system.action.damage.type.base}}
                {{#unless (eq item.type 'spell')}}
                    <div class="list-item">
                        <div class="list-item-start skinny">
                            <label data-tooltip="{{systemFields.action.fields.damage.fields.base.hint}}">{{systemFields.action.fields.damage.fields.base.label}}</label>
                        </div>
                        <div class="list-item-col">
                            {{formInput systemFields.action.fields.damage.fields.base value=system.action.damage.base
                                        classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                            {{formInput systemFields.action.fields.damage.fields.base_formula_operator
                                        value=system.action.damage.base_formula_operator
                                        classes="short skinny" rootId=@root.rootId disabled=@root.isPlayMode}}
                            {{formInput systemFields.action.fields.damage.fields.attribute
                                        value=system.action.damage.attribute options=(config2Array attributes) localize=true
                                        classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                        </div>
                    </div>

                    {{#unless (eq system.action.damage.type.base "matrix")}}
                        <div class="list-item">
                            <div class="list-item-start skinny">
                                <label data-tooltip="{{systemFields.action.fields.damage.fields.ap.fields.base.hint}}">{{systemFields.action.fields.damage.fields.ap.fields.base.label}}</label>
                            </div>
                            <div class="list-item-col">
                                {{formInput systemFields.action.fields.damage.fields.ap.fields.base
                                            value=system.action.damage.ap.base
                                            classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                                {{formInput systemFields.action.fields.damage.fields.ap.fields.base_formula_operator
                                            value=system.action.damage.ap.base_formula_operator
                                            classes="short skinny" rootId=@root.rootId disabled=@root.isPlayMode}}
                                {{formInput systemFields.action.fields.damage.fields.ap.fields.attribute
                                            value=system.action.damage.ap.attribute
                                            options=(config2Array attributes) localize=true
                                            classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                            </div>
                        </div>
                    {{/unless}}
                {{/unless}}
            {{/if}}
            <div class="list-item list-item-header">
                <div class="list-item-start skinny">
                    <label>{{systemFields.action.fields.opposed.fields.test.label}}</label>
                </div>
            </div>

            <div class="list-item">
                <div class="list-item-start skinny">
                    <label data-tooltip="{{systemFields.action.fields.opposed.fields.test.hint}}">{{systemFields.action.fields.opposed.fields.test.label}}</label>
                </div>
                <div class="list-item-col">
                    {{formInput systemFields.action.fields.opposed.fields.test value=system.action.opposed.test
                                options=(tests2Array opposedTests) classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                </div>
            </div>

            {{#if system.action.opposed.test}}
                <div class="list-item">
                    <div class="list-item-start skinny">
                        <label>{{localize "SR5.Roll"}}</label>
                    </div>
                    <div class="list-item-col">
                        {{!-- Hide this field the attribtue2 is set and the skill isn't set --}}
                        {{#unless (and system.action.opposed.attribute2 (not system.action.opposed.skill))}}
                            {{formInput systemFields.action.fields.opposed.fields.skill value=system.action.opposed.skill
                                        options=(config2Array activeSkills) localize=true
                                        classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                            <label>+</label>
                        {{/unless}}
                        {{formInput systemFields.action.fields.opposed.fields.attribute
                                    value=system.action.opposed.attribute
                                    options=(config2Array attributes) localize=true
                                    classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                        {{#unless system.action.opposed.skill}}
                            <label>+</label>
                            {{formInput systemFields.action.fields.opposed.fields.attribute2
                                        value=system.action.opposed.attribute2
                                        options=(config2Array attributes) localize=true
                                        classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                        {{/unless}}
                        <label>+</label>
                        {{formInput systemFields.action.fields.opposed.fields.mod value=system.action.opposed.mod
                                    classes="short skinny" rootId=@root.rootId disabled=@root.isPlayMode}}
                        <label>+</label>
                        <a data-tooltip="{{systemFields.action.fields.opposed.fields.resist.fields.armor.label}}:&nbsp;{{systemFields.action.fields.opposed.fields.resist.fields.armor.hint}}"
                           data-action="toggleOpposedArmor">
                            {{#if system.action.opposed.armor}}
                                <i class="fas fa-shield"></i>
                            {{else}}
                                <i class="far fa-shield"></i>
                            {{/if}}
                        </a>
                    </div>
                </div>
            {{/if}}
            <div class="list-item list-item-header">
                <div class="list-item-start skinny">
                    <label>{{systemFields.action.fields.opposed.fields.resist.fields.test.label}}</label>
                </div>
            </div>
            <div class="list-item">
                <div class="list-item-start skinny">
                    <label data-tooltip="{{systemFields.action.fields.opposed.fields.resist.fields.test.hint}}">{{systemFields.action.fields.opposed.fields.resist.fields.test.label}}</label>
                </div>
                <div class="list-item-col">
                    {{formInput systemFields.action.fields.opposed.fields.resist.fields.test
                                value=system.action.opposed.resist.test options=(tests2Array resistTests)
                                classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                </div>
            </div>

            {{#if system.action.opposed.resist.test}}
                <div class="list-item">
                    <div class="list-item-start skinny">
                        <label>{{localize "SR5.Roll"}}</label>
                    </div>
                    <div class="list-item-col">
                        {{formInput systemFields.action.fields.opposed.fields.resist.fields.attribute
                                    value=system.action.opposed.resist.attribute
                                    options=(config2Array attributes) localize=true
                                    classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                        <label>+</label>
                        {{formInput systemFields.action.fields.opposed.fields.resist.fields.attribute2
                                    value=system.action.opposed.resist.attribute2
                                    options=(config2Array attributes) localize=true
                                    classes="short" rootId=@root.rootId disabled=@root.isPlayMode}}
                        <label>+</label>
                        <a data-tooltip="{{systemFields.action.fields.opposed.fields.resist.fields.armor.label}}:&nbsp;{{systemFields.action.fields.opposed.fields.resist.fields.armor.hint}}"
                           data-action="toggleResistArmor">
                            {{#if system.action.opposed.resist.armor}}
                                <i class="fas fa-shield"></i>
                            {{else}}
                                <i class="far fa-shield"></i>
                            {{/if}}
                        </a>
                    </div>
                </div>
            {{/if}}
        </div>
    </div>
</section>
